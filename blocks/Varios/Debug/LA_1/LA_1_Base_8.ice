{
  "version": "1.1",
  "package": {
    "name": "Logic Analyzer 1 Base (8 channels)",
    "version": "1.0.0",
    "description": "NÃºcleo del analizador lÃ³gico LA_1 (8 canales)",
    "author": "Salvador E. Tropea",
    "image": "%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20height=%22730.62%22%20width=%22395.67mm%22%20viewBox=%220%200%20395.674%20193.312%22%3E%3Cg%20transform=%22translate(16.292%2026.115)%22%20fill=%22none%22%3E%3Crect%20ry=%2226.151%22%20height=%2291.47%22%20width=%22133.8%22%20stroke=%22#040404%22%20y=%2271.726%22%20x=%2221.923%22%20stroke-width=%224%22/%3E%3Cpath%20d=%22M23.057%20106.88l51.782-.38V89.491h20.033v17.389h45.358V89.113h13.607M24.007%20139.95h27.781l.189-17.387h28.348v17.387h42.333v-17.954l31.75.189%22%20stroke=%22#000%22%20stroke-width=%223%22/%3E%3C/g%3E%3Ctext%20font-weight=%22700%22%20font-size=%2242.06%22%20y=%2236.188%22%20x=%2242.807%22%20stroke-width=%222.576%22%20word-spacing=%220%22%20letter-spacing=%220%22%20transform=%22translate(-.832%20-2.232)%22%3E%3Ctspan%20y=%2236.188%22%20x=%2242.807%22%3ELogic%3C/tspan%3E%20%3C/text%3E%3Ctext%20font-size=%2242.06%22%20y=%2283.921%22%20x=%222.626%22%20stroke-width=%222.576%22%20fill=%22#00f%22%20word-spacing=%220%22%20letter-spacing=%220%22%20transform=%22translate(-.832%20-2.232)%22%3E%3Ctspan%20y=%2283.921%22%20x=%222.626%22%20font-weight=%22700%22%20fill=%22#000%22%3EAnalyzer%3C/tspan%3E%3C/text%3E%3Cpath%20d=%22M272.098%20173.248a30.451%2030.451%200%200%201-5.303-2.021c-3.366-1.758-8.344-6.786-10.144-10.241l-1.393-2.672-4.286-.115c-3.426-.09-4.82-.314-6.936-1.102-7.462-2.785-13.063-8.551-15.332-15.785-1.09-3.48-1.152-9.09-.136-12.488.376-1.262.631-2.329.564-2.366-5.359-3.103-10.086-9.195-11.744-15.132-.817-2.923-.651-8.787.335-11.957%201.46-4.685%204.84-9.516%208.71-12.44%201.084-.82%201.259-1.132.89-1.573-.893-1.077-2.413-5.764-2.656-8.203-.834-8.313%205.496-17.218%2014.06-19.782l2.254-.676-.238-2.58c-1.105-11.845%2010.1-22.242%2022.015-20.424%202.293.35%203.19.362%203.295.044.305-.912%203.22-4.287%204.873-5.637%202.278-1.863%206.34-3.73%209.084-4.174%207.332-1.192%2015.978%203.886%2019.754%2011.596l1.513%203.093.105%2056c.113%2060.219.153%2058.844-1.875%2064.253-4.052%2010.807-16.366%2017.268-27.41%2014.38zm54.58.192c-7.322-1.588-14.338-7.602-16.927-14.508-2.068-5.516-2.01-3.53-1.898-64.138l.1-56.22%201.53-3.088c3.781-7.637%2012.362-12.748%2019.476-11.604%202.805.451%205.198%201.403%207.763%203.073%202.16%201.41%205.416%204.758%206.12%206.295.385.844.555.886%202.403.588%201.092-.175%203.31-.295%204.933-.262%2010.45.203%2019.281%2010.134%2018.31%2020.583l-.244%202.619%201.277.265c4.963%201.027%2010.657%205.63%2013.071%2010.56%201.961%203.996%202.48%207.561%201.653%2011.36-.358%201.638-1.107%203.886-1.668%205l-1.021%202.029%201.297.977c3.803%202.872%207.191%207.72%208.669%2012.4.994%203.155%201.151%208.974.323%2011.957-1.453%205.208-5.494%2010.892-9.834%2013.815-.984.663-1.842%201.247-1.91%201.297-.068.053.188%201.124.566%202.386%201.014%203.395.951%209.01-.138%2012.488-2.259%207.199-7.908%2013.016-15.332%2015.785-2.116.789-3.51%201.012-6.936%201.102l-4.287.115-1.392%202.67c-1.798%203.455-6.779%208.486-10.136%2010.24-4.908%202.562-10.522%203.35-15.768%202.216z%22%20stroke=%22#000%22%20stroke-width=%222.504%22%20fill=%22#faa%22/%3E%3Cpath%20stroke-width=%222.504%22%20stroke=%22#000%22%20d=%22M271.738%20174.838a30.451%2030.451%200%200%201-5.3-2.024c-3.366-1.757-8.344-6.783-10.147-10.24l-1.39-2.67-4.286-.115c-3.426-.09-4.82-.313-6.937-1.102-7.462-2.785-13.063-8.551-15.332-15.788-1.091-3.478-1.151-9.09-.137-12.485.378-1.265.63-2.329.566-2.366-5.359-3.105-10.086-9.195-11.744-15.134-.82-2.92-.651-8.784.333-11.954%201.46-4.688%204.843-9.516%208.711-12.442%201.082-.817%201.26-1.127.892-1.57-.897-1.077-2.414-5.765-2.66-8.206-.831-8.313%205.5-17.218%2014.063-19.782l2.254-.676-.24-2.574c-1.102-11.852%2010.104-22.248%2022.015-20.428%202.296.35%203.19.363%203.297.044.303-.914%203.22-4.287%204.873-5.639%202.276-1.86%206.34-3.728%209.085-4.174%207.329-1.19%2015.978%203.889%2019.752%2011.599l1.515%203.092.105%2055.997c.113%2060.222.15%2058.844-1.878%2064.258-4.049%2010.805-16.364%2017.265-27.409%2014.378zm10.33-6.013c6.134-1.635%2010.606-6.255%2012.073-12.47.386-1.627.494-14.699.494-58.924V40.594l-1.152-2.078c-1.44-2.592-3.599-4.565-6.46-5.904-3.138-1.468-7.222-1.435-10.175.08-2.751%201.414-4.857%203.65-6.442%206.835-.782%201.57-1.718%202.842-2.352%203.195-.966.539-1.232.509-3.337-.38-3.396-1.435-8.113-1.382-11.18.12a12.605%2012.605%200%200%200-6.213%206.786c-.716%201.89-.849%202.9-.719%205.464.093%201.83.421%203.63.784%204.312.343.641%201.175%202.339%201.848%203.77%203.596%207.66%2013.972%2012.276%2021.993%209.784%203.313-1.027%205.784-2.714%208.987-6.135%202.186-2.333%202.965-2.92%203.874-2.92%202.559%200%203.894%202.38%202.667%204.746-1.17%202.258-6.085%206.72-9.208%208.358l-2.904%201.525.961.591c.528.326%202.467%202.103%204.302%203.956%204.142%204.167%206.077%207.597%206.485%2011.491.326%203.063.106%203.296-2.724%202.872-1.688-.252-1.765-.33-3.628-3.66-3.839-6.861-9.563-11.361-17.81-13.992-4.82-1.538-7.982-2.868-10.11-4.252-2.78-1.803-6.45-5.74-7.916-8.484l-1.294-2.424-1.63.25c-2.492.381-6.365%202.404-7.703%204.027-2.266%202.74-2.92%204.637-2.942%208.519-.025%204.019.619%205.859%203.063%208.759%202.258%202.681%201.813%204.352-1.633%206.134-2.66%201.373-6.325%204.878-7.492%207.162-1.963%203.839-2.499%208.641-1.422%2012.76%201.337%205.124%204.169%208.522%209.082%2010.893%204.282%202.07%204.432%202.529%202.454%207.6-1.26%203.24-1.277%209.122-.038%2012.49%203.105%208.42%2012.07%2012.62%2021.51%2010.076a32.272%2032.272%200%200%200%205.946-2.39c9.789-5.393%2012.69-14.02%208.289-24.616-2.835-6.831-9.315-10.875-16.94-10.574-2.096.08-2.4-.008-3.248-.994-1.192-1.383-1.187-2.667.012-4.057.917-1.067%201.065-1.102%204.62-1.069%2011.268.1%2019.55%206.798%2022.736%2018.39%201.01%203.68%201.087%209.115.178%2012.507-1.825%206.811-7.4%2013.221-14.658%2016.862-2.381%201.192-2.404%201.447-.408%204.607%202.183%203.45%206.303%206.46%2010.049%207.345%202.264.53%207.141.475%209.33-.108zm44.25%206.203c-7.319-1.585-14.338-7.6-16.927-14.508-2.068-5.516-2.008-3.53-1.898-64.135l.103-56.223%201.527-3.085c3.784-7.637%2012.365-12.748%2019.48-11.604%202.801.45%205.197%201.4%207.76%203.07%202.163%201.412%205.415%204.758%206.121%206.298.386.843.554.886%202.404.588%201.092-.176%203.31-.296%204.93-.263%2010.453.2%2019.284%2010.131%2018.313%2020.583l-.246%202.62%201.277.262c4.963%201.03%2010.66%205.632%2013.073%2010.562%201.958%203.996%202.477%207.562%201.65%2011.361-.355%201.635-1.107%203.886-1.667%205l-1.02%202.029%201.298.976c3.8%202.87%207.191%207.72%208.666%2012.4.997%203.156%201.152%208.975.325%2011.954-1.452%205.209-5.496%2010.892-9.833%2013.817a214.09%20214.09%200%200%200-1.91%201.297c-.068.054.187%201.122.563%202.387%201.017%203.395.954%209.007-.135%2012.485-2.259%207.201-7.908%2013.018-15.335%2015.788-2.116.789-3.508%201.012-6.936%201.102l-4.287.115-1.39%202.67c-1.8%203.455-6.78%208.483-10.139%2010.238-4.908%202.564-10.522%203.353-15.768%202.216zm12.215-7.137c4.708-2.2%207.405-5.396%209.338-11.07%201.317-3.873%201.965-4.269%205.801-3.548%203.468.651%207.795.356%2010.68-.734%204.405-1.662%208.196-5.664%209.691-10.226.841-2.561.962-8.4.225-10.812l-.485-1.602-5.404-.036c-5.66-.044-9.876-.663-14.168-2.09-2.234-.741-2.795-.784-5.371-.4-1.583.235-3.844.788-5.023%201.226-4.803%201.796-9.172%206.2-10.935%2011.023-.934%202.56-1.886%203.481-3.59%203.481-1.406%200-3.038-1.585-3.038-2.947%200-.564.388-1.938.859-3.055%202.894-6.836%208.578-12.337%2015.109-14.616l2.028-.71-1.685-2.173c-2.37-3.062-3.536-5.233-4.728-8.799-1.853-5.524-1.838-14.308.022-16.166%201.185-1.179%203.145-1.224%204.347-.095.847.794.877%201.02.666%205.584-.17%203.754-.075%205.296.451%207.307%201.543%205.874%205.927%2011.443%2010.765%2013.667%204.194%201.928%207.627%202.536%2014.388%202.546%205.544.008%206.022-.053%208.156-1.029%202.599-1.19%206.085-4.462%207.316-6.873%202.597-5.083%202.595-11.546-.004-16.634-1.139-2.226-4.79-5.74-7.416-7.137-1.187-.63-2.374-1.425-2.64-1.76-.876-1.127-.558-2.63.932-4.4%202.442-2.9%203.085-4.74%203.063-8.759-.025-3.88-.676-5.779-2.943-8.518-1.332-1.615-5.208-3.646-7.677-4.024l-1.607-.245-1.73%202.672c-2.427%203.74-6.714%207.905-9.589%209.304-3.01%201.468-7.642%201.8-11.74.842-3.426-.802-9.065-3.418-9.629-4.47-.7-1.307-.493-2.782.536-3.809%201.217-1.217%202.574-1.22%204.66-.008%204.32%202.502%2010.201%203.31%2013.424%201.848%202.136-.971%204.948-3.78%206.989-6.994%202.777-4.364%203.223-5.709%203.223-9.71%200-3.075-.143-3.826-1.092-5.757a13.088%2013.088%200%200%200-6.125-5.954c-2.63-1.212-8.138-1.187-10.73.044-1.014.483-2.078.876-2.369.876-1.079%200-2.276-1.277-3.408-3.635-2.982-6.218-8.864-9.21-14.82-7.542-4.162%201.166-8.144%205.003-9.183%208.854-.631%202.338-.308%20113.67.336%20115.95%201.682%205.974%205.977%2010.342%2011.846%2012.052%201.099.32%203.267.47%205.729.398%203.463-.103%204.287-.27%206.55-1.327z%22/%3E%3C/svg%3E"
  },
  "design": {
    "board": "kefir",
    "graph": {
      "blocks": [
        {
          "id": "input-clk",
          "type": "basic.input",
          "data": {
            "name": "clk",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": true
          },
          "position": {
            "x": 16,
            "y": 72
          }
        },
        {
          "id": "output-tx_data",
          "type": "basic.output",
          "data": {
            "name": "tx_data",
            "range": "[7:0]",
            "pins": [

{
 "index": "7",
 "name": "",
 "value": "0"
},

{
 "index": "6",
 "name": "",
 "value": "0"
},

{
 "index": "5",
 "name": "",
 "value": "0"
},

{
 "index": "4",
 "name": "",
 "value": "0"
},

{
 "index": "3",
 "name": "",
 "value": "0"
},

{
 "index": "2",
 "name": "",
 "value": "0"
},

{
 "index": "1",
 "name": "",
 "value": "0"
},

{
 "index": "0",
 "name": "",
 "value": "0"
}

            ],
            "virtual": true
          },
          "position": {
            "x": 1072,
            "y": 104
          }
        },
        {
          "id": "input-rst",
          "type": "basic.input",
          "data": {
            "name": "rst",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 144
          }
        },
        {
          "id": "input-tx_full",
          "type": "basic.input",
          "data": {
            "name": "tx_full",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 216
          }
        },
        {
          "id": "output-tx_wr",
          "type": "basic.output",
          "data": {
            "name": "tx_wr",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 1072,
            "y": 224
          }
        },
        {
          "id": "input-tx_ft_full",
          "type": "basic.input",
          "data": {
            "name": "tx_ft_full",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 288
          }
        },
        {
          "id": "output-wr",
          "type": "basic.output",
          "data": {
            "name": "wr",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 1072,
            "y": 352
          }
        },
        {
          "id": "input-rx_rd",
          "type": "basic.input",
          "data": {
            "name": "rx_rd",
            "pins": [
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 360
          }
        },
        {
          "id": "input-rx_data",
          "type": "basic.input",
          "data": {
            "name": "rx_data",
            "range": "[7:0]",
            "pins": [
              {
                "index": "7",
                "name": "",
                "value": "0"
              },
              {
                "index": "6",
                "name": "",
                "value": "0"
              },
              {
                "index": "5",
                "name": "",
                "value": "0"
              },
              {
                "index": "4",
                "name": "",
                "value": "0"
              },
              {
                "index": "3",
                "name": "",
                "value": "0"
              },
              {
                "index": "2",
                "name": "",
                "value": "0"
              },
              {
                "index": "1",
                "name": "",
                "value": "0"
              },
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 432
          }
        },
        {
          "id": "output-dbg",
          "type": "basic.output",
          "data": {
            "name": "dbg",
            "range": "[3:0]",
            "pins": [
              {
                "index": "3",
                "name": "",
                "value": "0"
              },
              {
                "index": "2",
                "name": "",
                "value": "0"
              },
              {
                "index": "1",
                "name": "",
                "value": "0"
              },
              {
                "index": "0",
                "name": "",
                "value": "0"
              }
            ],
            "virtual": true
          },
          "position": {
            "x": 1072,
            "y": 472
          }
        },
        {
          "id": "input-chn",
          "type": "basic.input",
          "data": {
            "name": "chn",
            "range": "[7:0]",
            "pins": [

{
 "index": "7",
 "name": "",
 "value": "0"
},

{
 "index": "6",
 "name": "",
 "value": "0"
},

{
 "index": "5",
 "name": "",
 "value": "0"
},

{
 "index": "4",
 "name": "",
 "value": "0"
},

{
 "index": "3",
 "name": "",
 "value": "0"
},

{
 "index": "2",
 "name": "",
 "value": "0"
},

{
 "index": "1",
 "name": "",
 "value": "0"
},

{
 "index": "0",
 "name": "",
 "value": "0"
}

            ],
            "virtual": true,
            "clock": false
          },
          "position": {
            "x": 16,
            "y": 504
          }
        },
        {
          "id": "constant-CLK_DIV",
          "type": "basic.constant",
          "data": {
            "name": "CLK_DIV",
            "value": "1",
            "local": false
          },
          "position": {
            "x": 232,
            "y": -64
          }
        },
        {
          "id": "constant-N_FIFO",
          "type": "basic.constant",
          "data": {
            "name": "N_FIFO",
            "value": "9",
            "local": false
          },
          "position": {
            "x": 384,
            "y": -64
          }
        },
        {
          "id": "constant-N_TX",
          "type": "basic.constant",
          "data": {
            "name": "N_TX",
            "value": "10",
            "local": false
          },
          "position": {
            "x": 536,
            "y": -64
          }
        },
        {
          "id": "constant-C_TX",
          "type": "basic.constant",
          "data": {
            "name": "C_TX",
            "value": "1000",
            "local": false
          },
          "position": {
            "x": 688,
            "y": -64
          }
        },
        {
          "id": "constant-F_CLK",
          "type": "basic.constant",
          "data": {
            "name": "F_CLK",
            "value": "60",
            "local": false
          },
          "position": {
            "x": 840,
            "y": -64
          }
        },
        {
          "id": "37adbf83-88c5-44c0-82e6-5521a43010a3",
          "type": "basic.code",
          "data": {
            "code": "localparam N_CH=8;\n/***********************************************************************\n\n  Logic Analyzer 1 (base module)\n\n  This file is part FPGA Libre project http://fpgalibre.sf.net/\n\n  Description:\n  Implements an internal logic analyzer of 8/16/32 channels using\n  the FT245 sync FIFO core.\n  Implements 1 stage trigger and supports independent clock.\n  This module is the logic analyzer itself (without support logic)\n\n  To Do:\n  -\n\n  Author:\n    - Salvador E. Tropea, salvador en inti.gob.ar\n\n------------------------------------------------------------------------------\n\n Copyright (c) 2017 Salvador E. Tropea <salvador en inti.gob.ar>\n Copyright (c) 2017 Instituto Nacional de Tecnología Industrial\n\n Distributed under the GPL v2 or newer license\n\n------------------------------------------------------------------------------\n\n Design unit:      LA_1_Base(RTL) (Entity and architecture)\n File name:        la_1_base.v\n Note:             None\n Limitations:      None known\n Errors:           None known\n Library:          avr\n Dependencies:     IEEE.std_logic_1164\n                   IEEE.numeric_std\n                   utils.stdlib\n                   mems.devices\n Target FPGA:      iCE40HX4K-TQ144\n Language:         Verilog\n Wishbone:         None\n Synthesis tools:  Lattice iCECube2 2017.01.27914\n Simulation tools: GHDL [Sokcho edition] (0.2x)\n Text editor:      SETEdit 0.5.x\n\n***********************************************************************/\n\nreg             start_r;\nreg             start_acq_r=0;\nreg             was_full;\nwire            next_data;\nwire            tx_wr;\n\nwire [N_CH-1:0] acq_data;\nreg  [N_CH-1:0] acq_data_r;\n\n// Triggers\nreg  [N_CH-1:0] trg_mask=0;\nreg  [N_CH-1:0] trg_value=0;\nreg  [N_CH-1:0] trg_edge=0;\nwire [N_CH-1:0] acq_edge;\nwire            trigger;\n\nreg  [1:0]      cnt_rx=2'b0;\n\nreg  [N_TX-1:0] cnt_tx=0;\nwire [1:0]      cnt_tx_sel;\nreg  [7:0]      cnt_cdiv=7'b0;\n\n// Config\nreg             cfg_src_r=1'b0; // Read from the config registers\nwire [N_CH-1:0] cfg_data; // Data for the host\n\nassign tx_data_o=cfg_src_r ? cfg_data : acq_data_r;\nassign acq_data=chn_i;\n\ngenerate\nif (N_CH==8)\n   begin : cfg_8\n   assign cnt_tx_sel=cnt_tx[1:0];\n   assign cfg_data=cnt_tx_sel==2'd0 ? 8'h08 : (  // 8 channels\n                   cnt_tx_sel==2'd1 ? N_FIFO[7:0] : ( // FIFO size\n                   cnt_tx_sel==2'd2 ? CLK_DIV[7:0] : (// Clock divider\n                                      F_CLK[7:0])));  // Clock\n   end // cfg_8\nelse if (N_CH==16)\n   begin : cfg_16\n   assign cfg_data=cnt_tx[0]==1'b0 ? {N_FIFO[7:0], 8'h10} :      // 16 channels/FIFO size\n                                     {F_CLK[7:0], CLK_DIV[7:0]}; // Clock divider/Clock\n   end // cfg_16\nelse if (N_CH==32)\n   begin : cfg_32\n   assign cfg_data={F_CLK[7:0], CLK_DIV[7:0], N_FIFO[7:0], 8'h20};\n   end // cfg_32\nendgenerate\n\nassign tx_wr=!tx_full_i && (start_acq_r || (start_r && trigger)) && cnt_cdiv==0;\nassign tx_wr_o=tx_wr;\n\nassign next_data=!tx_full_i && start_r && cnt_cdiv==0 && !cfg_src_r;\nassign wr_o=next_data;\n\nalways @(posedge clk_i)\nbegin : do_clk_div\n  if (rst_i || (rx_rd_i && rx_data_i[0]))\n     cnt_cdiv <= 0;\n  else\n     begin\n     cnt_cdiv <= cnt_cdiv+1;\n     if (cnt_cdiv==CLK_DIV-1)\n        cnt_cdiv <= 0;\n     end\nend // do_clk_div\n\nalways @(posedge clk_i)\nbegin : do_regs\n  if (rst_i)\n     begin\n     start_r     <= 1'b0;\n     start_acq_r <= 1'b0;\n     cfg_src_r   <= 1'b0;\n     was_full    <= 1'b0;\n     cnt_tx      <= {N_TX{1'b0}};\n     cnt_rx      <= 2'b0;\n     trg_mask    <= 8'b0;\n     trg_value   <= 8'b0;\n     trg_edge    <= 8'b0;\n     end\n  else\n     begin\n     if (tx_ft_full_i && start_r)\n         was_full <= 1'b1;\n     // Start writing\n     if (start_r && (trigger || cfg_src_r))\n        start_acq_r <= 1'b1;\n     // Stop after filling the FIFO once\n     if (tx_wr)\n        begin\n        cnt_tx <= cnt_tx+1;\n        if (cnt_tx==C_TX-1 ||\n           (cfg_src_r && cnt_tx[1:0]==2'b11 && N_CH==8)  ||\n           (cfg_src_r && cnt_tx[0:0]==1'b1  && N_CH==16) ||\n           (cfg_src_r && N_CH==32))\n           begin\n           start_r     <= 1'b0;\n           start_acq_r <= 1'b0;\n           end\n        end\n     // Registers\n     if (rx_rd_i)\n        begin\n        cnt_rx <= cnt_rx+1;\n        case (cnt_rx)\n             2'd0: trg_mask  <= rx_data_i;\n             2'd1: trg_value <= rx_data_i;\n             2'd2: trg_edge  <= rx_data_i;\n             2'd3:\n                begin\n                start_r   <= rx_data_i[0];\n                cfg_src_r <= rx_data_i[1];\n                if (!start_r && rx_data_i[0])\n                   begin\n                   was_full <= 1'b0;\n                   cnt_tx <= {N_TX{1'b0}};\n                   // If we don't have a trigger start acq right now\n                   if (trg_mask==8'b0)\n                      start_acq_r <= 1'b1;\n                   end\n                if (!rx_data_i[0])\n                   start_acq_r <= 1'b0;\n                end\n        endcase\n        end\n     if (!rx_rd_i)\n        // Ensure we go back to 0 after a burst\n        cnt_rx <= 2'b0;\n     end\nend // do_regs\n\n////////////////////////////////\n// 4 bits debug output (LEDs) //\n////////////////////////////////\n//assign dbg_o={1'b0,status_empty,was_full,start_r};\n//assign dbg_o={2'b0,cnt_rx};\n//assign dbg_o={ft_full,1'b0,cnt_rx2};\n//assign dbg_o=dbg_fifo;\n//assign dbg_o=trg_edge[3:0];\n//assign dbg_o=trg_mask[3:0];\n//assign dbg_o=trg_value[3:0];\nassign dbg_o=4'b0;\n\n///////////////////\n// Trigger logic //\n///////////////////\nalways @(posedge clk_i)\nbegin : do_acq_data_r\n  if (next_data)\n     acq_data_r <= acq_data;\nend // do_acq_data_r\n\nassign acq_edge=(acq_data_r ^ acq_data) &&\n                trg_edge; // Ignore edges on level triggers\n\nassign trigger=trg_mask==8'b0 || // No mask, always triggered\n               ((trg_value ~^ acq_data_r) & // Compare the data with the trigger value\n                (trg_edge  ~^ acq_edge) &   // Compare the data edge with the trigger edge\n                 trg_mask)==trg_mask; // Apply the trigger mask   ",
            "params": [
              {
                "name": "CLK_DIV"
              },
              {
                "name": "N_FIFO"
              },
              {
                "name": "N_TX"
              },
              {
                "name": "C_TX"
              },
              {
                "name": "F_CLK"
              }
            ],
            "ports": {
              "in": [
                {
                  "name": "clk_i"
                },
                {
                  "name": "rst_i"
                },
                {
                  "name": "tx_full_i"
                },
                {
                  "name": "tx_ft_full_i"
                },
                {
                  "name": "rx_rd_i"
                },
                {
                  "name": "rx_data_i",
                  "range": "[7:0]",
                  "size": 8
                },
                {
                  "name": "chn_i",
                  "range": "[7:0]",
                  "size": 8
                }
              ],
              "out": [
                {
                  "name": "tx_data_o",
                  "range": "[7:0]",
                  "size": 8
                },
                {
                  "name": "tx_wr_o"
                },
                {
                  "name": "wr_o"
                },
                {
                  "name": "dbg_o",
                  "range": "[3:0]",
                  "size": 4
                }
              ]
            }
          },
          "position": {
            "x": 208,
            "y": 72
          },
          "size": {
            "width": 752,
            "height": 496
          }
        }
      ],
      "wires": [
        {
          "source": {
            "block": "input-clk",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "clk_i"
          }
        },
        {
          "source": {
            "block": "input-rst",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "rst_i"
          }
        },
        {
          "source": {
            "block": "input-tx_full",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "tx_full_i"
          }
        },
        {
          "source": {
            "block": "input-tx_ft_full",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "tx_ft_full_i"
          }
        },
        {
          "source": {
            "block": "input-rx_rd",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "rx_rd_i"
          }
        },
        {
          "source": {
            "block": "input-rx_data",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "rx_data_i"
          },
          "size": 8
        },
        {
          "source": {
            "block": "input-chn",
            "port": "out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "chn_i"
          },
          "size": 8
        },
        {
          "source": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "tx_data_o"
          },
          "target": {
            "block": "output-tx_data",
            "port": "in"
          },
          "size": 8
        },
        {
          "source": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "tx_wr_o"
          },
          "target": {
            "block": "output-tx_wr",
            "port": "in"
          }
        },
        {
          "source": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "wr_o"
          },
          "target": {
            "block": "output-wr",
            "port": "in"
          }
        },
        {
          "source": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "dbg_o"
          },
          "target": {
            "block": "output-dbg",
            "port": "in"
          },
          "size": 4
        },
        {
          "source": {
            "block": "constant-CLK_DIV",
            "port": "constant-out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "CLK_DIV"
          }
        },
        {
          "source": {
            "block": "constant-N_FIFO",
            "port": "constant-out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "N_FIFO"
          }
        },
        {
          "source": {
            "block": "constant-N_TX",
            "port": "constant-out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "N_TX"
          }
        },
        {
          "source": {
            "block": "constant-C_TX",
            "port": "constant-out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "C_TX"
          }
        },
        {
          "source": {
            "block": "constant-F_CLK",
            "port": "constant-out"
          },
          "target": {
            "block": "37adbf83-88c5-44c0-82e6-5521a43010a3",
            "port": "F_CLK"
          }
        }
      ]
    },
    "state": {
      "pan": {
        "x": 368,
        "y": 209.5
      },
      "zoom": 1
    }
  },
  "dependencies": {

  }
}
